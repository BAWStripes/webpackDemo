{"version":3,"sources":["waterfall.js"],"names":[],"mappings":"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","file":"waterfall-compiled.js","sourcesContent":["module.exports = (function(){\r\n\r\n    let $ =require('../jquery.min');\r\n    function WaterFall(ct) {\r\n        this.$ct = ct;\r\n        this.$item = this.$ct.find('.waterfall-item');\r\n        this.$btnLoad = this.$ct.siblings('.loadMore');\r\n        this.bind();\r\n        this.start();\r\n    }\r\n\r\n    WaterFall.prototype.bind = function () {\r\n        var _this = this;\r\n        this.curpage = 1;\r\n        this.perPageCount = 10;\r\n        this.itemArr = [];\r\n        this.colLength = parseInt(this.$ct.width() / this.$item.width());\r\n        for (var i = 0; i < this.colLength; i++) {\r\n            this.itemArr[i] = 0;\r\n        }\r\n        this.$btnLoad.click(function (e) {\r\n            _this.start();\r\n        })\r\n    };\r\n\r\n    WaterFall.prototype.start = function () {\r\n        var _this = this;\r\n        this.getData(function (data) {\r\n            $.each(data, function (idx, news) {\r\n                var $node = _this.getNode(news)\r\n                $node.find('img').load(function () {\r\n                    _this.$ct.append($node)\r\n                    _this.fallFlow($node)\r\n                })\r\n                $node.find('img').on('click',function (e) {\r\n                    e.preventDefault();\r\n                })\r\n            })\r\n        })\r\n    };\r\n\r\n    WaterFall.prototype.getData = function (callback) {\r\n        var _this = this;\r\n        $.ajax({\r\n            url: '//platform.sina.com.cn/slide/album_tech?jsoncallback=func&app_key=1271687855&num=3&page=4',\r\n            dataType: 'jsonp',\r\n            jsonp: \"jsoncallback\",\r\n            data: {\r\n                app_key: 1271687855,\r\n                num: _this.perPageCount,\r\n                page: _this.curpage\r\n            }\r\n        }).done(function (ret) {\r\n            if (ret && ret.status && ret.status.code === '0') {\r\n                callback(ret.data);\r\n                _this.curpage++;\r\n            } else {\r\n                console.log('get error data')\r\n            }\r\n        })\r\n    };\r\n\r\n    WaterFall.prototype.getNode = function (data) {\r\n        var html = '';\r\n        html += '<li class=\"waterfall-item\"><a href=\"' + data.url+'\">';\r\n        html += '<img src=\"' + data.img_url + '\"></a>';\r\n        html += '<h4>' + data.short_name + '</h4>';\r\n        html += '<p>' + data.name + '</p></li>';\r\n        return $(html);\r\n    };\r\n\r\n    WaterFall.prototype.fallFlow = function ($nodes) {\r\n        var _this = this;\r\n        $nodes.each(function () {\r\n            var minValue = Math.min.apply(null, _this.itemArr);\r\n            var minIndex = _this.itemArr.indexOf(minValue);\r\n            $(this).css({\r\n                top: _this.itemArr[minIndex],\r\n                left: minIndex * $('.waterfall-item').outerWidth(true)\r\n            });\r\n            _this.itemArr[minIndex] += $(this).outerHeight(true)\r\n            _this.$ct.css({height: Math.max.apply(null, _this.itemArr)})\r\n        })\r\n    };\r\n    WaterFall2 = (function () {\r\n        return {\r\n            init: function ($ct) {\r\n                $ct.each(function (idx, ct) {\r\n                    new WaterFall($(ct));\r\n                })\r\n            }\r\n        }\r\n    })();\r\n    return WaterFall2;\r\n})();"]}